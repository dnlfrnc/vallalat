<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Knowledge Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
        }
        .quiz-card {
            background-color: #ffffff;
            border: 1px solid #e2e8f0; /* Light gray border */
            box-shadow: 0 6px A12px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease-in-out;
            min-height: 400px; /* Ensure cards have a minimum height */
        }
        .answer-option-label {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            border: 1px solid #cbd5e1;
            border-radius: 0.5rem; /* rounded-lg */
            background-color: #f8fafc;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            margin-bottom: 0.75rem; /* space-y-3 equivalent */
        }
        .answer-option-label:hover {
            background-color: #e2e8f0;
            border-color: #94a3b8;
        }
        .answer-input[type="radio"], .answer-input[type="checkbox"] {
            width: 1.25rem;
            height: 1.25rem;
            margin-right: 0.75rem;
            flex-shrink: 0;
            appearance: none;
            border: 1px solid #cbd5e1;
            background-color: #fff;
            transition: all 0.2s ease-in-out;
        }
        .answer-input[type="radio"] {
            border-radius: 50%; /* Circle for radio buttons */
        }
        .answer-input[type="radio"]:checked {
            background-color: #3b82f6; /* Blue for checked */
            border-color: #3b82f6;
            box-shadow: inset 0 0 0 4px #fff;
        }
        .answer-input[type="checkbox"] {
            border-radius: 0.25rem; /* Square for checkboxes */
        }
        .answer-input[type="checkbox"]:checked {
            background-color: #3b82f6; /* Blue for checked */
            border-color: #3b82f6;
            /* A custom checkmark using box-shadow */
            background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
        }

        /* Styles for feedback */
        .feedback-message {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            text-align: center;
        }
        .feedback-correct {
            background-color: #d1fae5; color: #065f46; border: 1px solid #34d399;
        }
        .feedback-incorrect {
            background-color: #fee2e2; color: #991b1b; border: 1px solid #ef4444;
        }
        .submit-btn, .next-btn, .restart-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .submit-btn {
            background-color: #3b82f6; color: #ffffff;
        }
        .submit-btn:hover:not(:disabled) {
            background-color: #2563eb;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .submit-btn:disabled {
            background-color: #93c5fd; cursor: not-allowed; box-shadow: none;
        }
        .next-btn {
            background-color: #10b981; color: #ffffff;
        }
        .next-btn:hover:not(:disabled) {
            background-color: #059669;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .next-btn:disabled {
            background-color: #a7f3d0; cursor: not-allowed; box-shadow: none;
        }
        .restart-btn {
            background-color: #3b82f6; color: #ffffff;
        }
        .score-display {
            background-color: #ecfeff; color: #0f766e; border: 1px solid #2dd4bf;
        }

        /* Styles for highlighting correct/incorrect answers */
        .answer-option-label.correct-highlight {
            background-color: #d1fae5; border-color: #34d399; color: #065f46;
        }
        .answer-option-label.incorrect-highlight {
            background-color: #fee2e2; border-color: #ef4444; color: #991b1b;
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">
    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">
                V√°llalatgazdas√°gtan Kv√≠z
            </h1>
        </header>

        <div id="quiz-container" class="quiz-card p-6 sm:p-8 rounded-lg relative">
            <p class="text-sm text-gray-500 mb-4">Question <span id="current-question-number"></span> / <span id="total-quiz-questions"></span></p>
            <h2 id="question-text" class="text-xl sm:text-2xl font-semibold text-gray-900 mb-6"></h2>
            <div id="answers-container" class="space-y-3"></div>
            <div id="feedback-message" class="feedback-message hidden"></div>
            <div class="flex flex-col sm:flex-row justify-between items-center mt-8 space-y-4 sm:space-y-0">
                <button id="submit-button" class="submit-btn w-full sm:w-auto" disabled>Submit Answer</button>
                <button id="next-button" class="next-btn w-full sm:w-auto hidden" disabled>Next Question &rarr;</button>
            </div>
        </div>

        <div id="results-container" class="quiz-card p-6 sm:p-8 rounded-lg text-center hidden">
            <h2 class="text-2xl sm:text-3xl font-semibold text-gray-900 mb-4">Quiz Completed!</h2>
            <p id="score-text" class="text-xl sm:text-2xl font-bold score-display p-4 rounded-lg"></p>
            <button id="restart-button" class="restart-btn mt-6 w-full sm:w-auto">Restart Quiz</button>
        </div>
    </div>
        
    <script>
        // RE-CATEGORIZED and BALANCED Question Pool
        const allQuizData = [
            // Category: Fundamentals & Legal
            { "question": "Milyen jogi form√°ban m≈±k√∂dhet a v√°llalkoz√°s?", "answers": [{ "text": "gazdas√°gi t√°rsas√°gk√©nt", "is_correct": true }, { "text": "√∂nkorm√°nyzatk√©nt", "is_correct": false }, { "text": "alkalmazottk√©nt", "is_correct": false }], "category": "Fundamentals & Legal" },
            { "question": "Jel√∂lje meg, hogy az al√°bbi √°ll√≠t√°sok k√∂z√ºl melyek igazak! (Egy√©ni v√°llalkoz√≥)", "answers": [{ "text": "Az egy√©ni v√°llalkoz√≥ korl√°tlanul felel≈ës a v√°llalkoz√°s√©rt.", "is_correct": true }, { "text": "Az egy√©ni v√°llalkoz√≥ nem szerepelhet a c√©gjegyz√©kben.", "is_correct": false }, { "text": "Az egy√©ni v√°llalkoz√≥ t√°rsas√°gi szerz≈ëd√©st k√∂t.", "is_correct": false }], "category": "Fundamentals & Legal" },
            { "question": "Jel√∂lje meg, hogy az al√°bbi √°ll√≠t√°sok k√∂z√ºl melyek igazak! (K√∂zkereseti t√°rsas√°g, Kft)", "answers": [{ "text": "A k√∂zkereseti t√°rsas√°g vezet≈ëje az √ºgyvezet≈ë.", "is_correct": false }, { "text": "A korl√°tolt felel≈ëss√©g≈± t√°rsas√°g vezet≈ëje az √ºgyvezet≈ë.", "is_correct": true }, { "text": "A k√∂zkereseti t√°rsas√°g jogi szem√©ly.", "is_correct": false }], "category": "Fundamentals & Legal" },
            { "question": "Melyik gazdas√°gi szervezetre jellemz≈ëek az al√°bbiak? saj√°t √ºzletr√©sz√©nek tulajdonosa lehet; tagj√°nak felel≈ëss√©ge korl√°tozott; jogi szem√©ly", "answers": [{ "text": "korl√°tolt felel≈ëss√©g≈± t√°rsas√°g", "is_correct": true }, { "text": "bet√©ti t√°rsas√°g", "is_correct": false }, { "text": "egyes√ºlet", "is_correct": false }], "category": "Fundamentals & Legal" },
            { "question": "V√°lassza ki az al√°bbiak k√∂z√ºl azt, amely nem igaz a sz√∂vetkezetekre!", "answers": [{ "text": "minden tagj√°nak azonos jogai vannak", "is_correct": false }, { "text": "jogi szem√©ly", "is_correct": false }, { "text": "vezet≈ëje az √ºgyvezet≈ë", "is_correct": true }], "category": "Fundamentals & Legal" },
            { "question": "Milyen √∫j v√°llalkoz√°si form√°k lehets√©gesek 2004. m√°jus 1. √≥ta Magyarorsz√°gon is? (Eur√≥pai t√°rsas√°gok)", "answers": [{ "text": "az eur√≥pai korl√°tolt felel≈ëss√©g≈± t√°rsas√°g", "is_correct": false }, { "text": "az eur√≥pai sz√∂vetkezet", "is_correct": true }, { "text": "az eur√≥pai r√©szv√©nyt√°rsas√°g", "is_correct": true }], "category": "Fundamentals & Legal" },
            { "question": "Az al√°bbi √°ll√≠t√°sok k√∂z√ºl melyik igaz? (√úzleti tev√©kenys√©g alap√≠tv√°ny, egyes√ºlet, sz√∂vetkezet)", "answers": [{ "text": "√úzleti tev√©kenys√©get v√©gezhet alap√≠tv√°ny.", "is_correct": true }, { "text": "√úzleti tev√©kenys√©get nem v√©gezhet egyes√ºlet.", "is_correct": false }, { "text": "√úzleti tev√©kenys√©get v√©gezhet sz√∂vetkezet.", "is_correct": true }], "category": "Fundamentals & Legal" },
            { "question": "Az al√°bbiak k√∂z√ºl melyik √°ll√≠t√°s a helyes? Jel√∂lje meg a helyes v√°laszt!", "answers": [{ "text": "Az egy√©ni c√©g. jogi szem√©lyis√©ggel rendelkez≈ë gazdas√°gi t√°rsas√°g.", "is_correct": false }, { "text": "A Kft. jogi szem√©lyis√©ggel rendelkez≈ë gazdas√°gi t√°rsas√°g.", "is_correct": true }, { "text": "Az Rt. jogi szem√©lyis√©ggel nem rendelkez≈ë gazdas√°gi t√°rsas√°g.", "is_correct": false }], "category": "Fundamentals & Legal" },
            { "question": "D√∂ntse el, hogy az al√°bbi √°ll√≠t√°sok k√∂z√ºl melyik igaz a Kft. eset√©n!", "answers": [{ "text": "A tagok felel≈ëss√©ge korl√°tlan √©s egyetemleges.", "is_correct": false, "correct_answer": "hamis" }, { "text": "El≈ëre meghat√°rozott t√∂rzsbet√©tekb≈ël √°ll√≥ t√∂rzst≈ëk√©vel alap√≠tj√°k.", "is_correct": true, "correct_answer": "igaz" }, { "text": "Alap√≠t√°s√°hoz sz√ºks√©ges minim√°lis t≈ëke 10 milli√≥ forint.", "is_correct": false, "correct_answer": "hamis" }], "category": "Fundamentals & Legal" },
            { "question": "A v√°llalatelm√©letek c√©lja...", "answers": [{ "text": "konkr√©t gazdas√°gi probl√©m√°k megold√°s√°nak kidolgoz√°sa.", "is_correct": false }, { "text": "a v√°llalati m≈±k√∂d√©s r√©szletes le√≠r√°sa.", "is_correct": false }, { "text": "a v√°llalatok l√©tez√©s√©nek indokl√°sa, l√©tjogosults√°guk vizsg√°lata.", "is_correct": true }, { "text": "szak√©rt≈ëi rendszerek kidolgoz√°sa, mint tan√°csad√≥i funkci√≥.", "is_correct": false }], "category": "Fundamentals & Legal" },
            { "question": "Adja meg, hogy az al√°bbi v√°llalati form√°k k√∂z√ºl melyek rendelkeznek jogi szem√©lyis√©ggel!", "answers": [{ "text": "r√©szv√©nyt√°rsas√°g", "is_correct": true, "correct_answer": "J" }, { "text": "egy√©ni c√©g", "is_correct": false, "correct_answer": "N" }, { "text": "bet√©ti t√°rsas√°g", "is_correct": false, "correct_answer": "N" }, { "text": "k√∂zkereseti t√°rsas√°g", "is_correct": false, "correct_answer": "N" }, { "text": "korl√°tolt felel≈ëss√©g≈± t√°rsas√°g", "is_correct": true, "correct_answer": "J" }, { "text": "egyszem√©lyes kft.", "is_correct": false, "correct_answer": "N" }], "category": "Fundamentals & Legal" },

            // Category: Strategy & Management
            { "question": "Melyik a r√©szv√©nyt√°rsas√°g tulajdonosi szervezete?", "answers": [{ "text": "a vezet≈ës√©g", "is_correct": false }, { "text": "az igazgat√≥s√°gi eln√∂k", "is_correct": false }, { "text": "k√∂zgy≈±l√©s", "is_correct": true }], "category": "Strategy & Management" },
            { "question": "V√°lassza ki az al√°bbiak k√∂z√ºl a divizion√°lis szervezeti form√°ra jellemz≈ëket!", "answers": [{ "text": "Az egyes div√≠zi√≥k valamilyen m√©rt√©kben √∂n√°ll√≥ak.", "is_correct": true }, { "text": "A strat√©giai feladatokat k√∂zponti egys√©gek l√°tj√°k el.", "is_correct": true }, { "text": "A div√≠zi√≥k k√ºl√∂n jogi szem√©lyek.", "is_correct": false }], "category": "Strategy & Management" },
            { "question": "V√°lassza ki az al√°bbi meg√°llap√≠t√°sok k√∂z√ºl azt, amely nem jellemz≈ë a line√°ris szervezeti form√°ra!", "answers": [{ "text": "a szervezet horizont√°lisan b≈ëv√≠thet≈ë", "is_correct": false }, { "text": "a szervezeti egys√©gek √∂n√°ll√≥ak", "is_correct": true }, { "text": "a szervezetre jellemz≈ë a szolg√°lati utak rendszere", "is_correct": false }], "category": "Strategy & Management" },
            { "question": "V√°lassza ki az al√°bbiak k√∂z√ºl a v√°llalati szervezeti szinteket!", "answers": [{ "text": "menedzserek", "is_correct": true }, { "text": "k√©pvisel≈ëk", "is_correct": false }, { "text": "b√ºrokrat√°k", "is_correct": true }], "category": "Strategy & Management" },
            { "question": "Az al√°bbi √°ll√≠t√°sok k√∂z√ºl melyik igaz? (T√∂rzskar, staff)", "answers": [{ "text": "A t√∂rzskar (staff) nem a v√©grehajt√≥ szervezet r√©sze.", "is_correct": true }, { "text": "A t√∂rzskar csak katonai szervezetekn√©l haszn√°lt elem.", "is_correct": false }, { "text": "A t√∂rzskar feladata mindig az ellen≈ërz√©s.", "is_correct": false }], "category": "Strategy & Management" },
            { "question": "V√°lassza ki az al√°bbiak k√∂z√ºl, hogy melyek jelentik a tulajdonosi funkci√≥k gyakorl√°s√°nak m√≥dj√°t!", "answers": [{ "text": "k√∂zvetlen tulajdonosi fel√ºgyelet", "is_correct": true }, { "text": "vagyonkezel≈ëk√∂n kereszt√ºl gyakorolt tulajdonl√°s", "is_correct": true }, { "text": "ingatlankezel≈ëk√∂n kereszt√ºl gyakorolt tulajdonl√°s", "is_correct": false }], "category": "Strategy & Management" },
            { "question": "V√°lassza ki, hogy a v√°llalatok v√©telen√©l melyik kifejez√©seket haszn√°lj√°k!", "answers": [{ "text": "kiv√°s√°rl√°s", "is_correct": true }, { "text": "akviz√≠ci√≥", "is_correct": true }, { "text": "strat√©giai sz√∂vets√©g", "is_correct": false }], "category": "Strategy & Management" },
            { "question": "V√°lassza ki, hogy az al√°bbiak k√∂z√ºl melyik igaz a h√°l√≥zatos v√°llalatcsoportra!", "answers": [{ "text": "a h√°l√≥zatos v√°llalatcsoportban egy vezet≈ë v√°llalat van", "is_correct": false }, { "text": "a h√°l√≥zatos v√°llalatcsoportban t√∂bb vezet≈ë er≈ëk√∂zpont tal√°lhat√≥", "is_correct": true }, { "text": "a h√°l√≥zatos v√°llalatcsoportban felismerhet≈ë a hierarchia", "is_correct": false }], "category": "Strategy & Management" },
            { "question": "V√°lassza ki, hogy a k√∂zvetett tulajdon√∫ v√°llalatcsoportnak melyik jellemz≈ëje!", "answers": [{ "text": "van a csoportban olyan v√°llalat, amely tulajdonos", "is_correct": true }, { "text": "csak egy tulajdonosa lehet", "is_correct": false }, { "text": "az √°llam szerepel mint eredeti tulajdonos", "is_correct": true }], "category": "Strategy & Management" },
            { "question": "Jel√∂lje meg, hogy az al√°bbi √°ll√≠t√°sok igazak! (Strat√©giai sz√∂vets√©g)", "answers": [{ "text": "A strat√©giai sz√∂vets√©g l√©trehozhat√≥ beszerz√©sre.", "is_correct": true }, { "text": "A v√°llalatcsoport tagjai k√∂z√∂tt tulajdonosi kapcsolatok vannak.", "is_correct": true }, { "text": "A konzorcium mindig v√°llalatcsoport.", "is_correct": false }], "category": "Strategy & Management" },
            { "question": "Jel√∂lje meg, hogy az al√°bbi √°ll√≠t√°sok k√∂z√ºl melyik igaz! (V√≠z√≥/K√ºldet√©s)", "answers": [{ "text": "A v√≠zi√≥ megfogalmaz√°sa egy t√∂bb oldalas dokumentumban t√∂rt√©nik.", "is_correct": false }, { "text": "A k√ºldet√©sben a v√°llalkoz√°sok alapvet≈ë c√©ljaikat fogalmazz√°k meg.", "is_correct": true }, { "text": "A k√ºldet√©s elk√©sz√≠t√©se a b√ºrokrat√°k, szakalkalmazottak feladatk√∂r√©be tartozik.", "is_correct": false }], "category": "Strategy & Management" },
            { "question": "V√°lassza ki, hogy kinek a feladatk√∂r√©be tartoznak a szakmai strat√©gi√°k kidolgoz√°sa!", "answers": [{ "text": "a tulajdonosok feladata", "is_correct": false }, { "text": "a t√∂rzskari vezet≈ëk feladata", "is_correct": false }, { "text": "a funkcion√°lis vezet≈ëk feladata", "is_correct": true }], "category": "Strategy & Management" },
            { "question": "V√°lassza ki a k√ºl√∂nf√©le id≈ët√°v√∫ tervekre jellemz≈ëket! (K√©sz√ºlhetnek √∂sszehangoltan)", "answers": [{ "text": "k√©sz√ºlhetnek √∂sszehangoltan", "is_correct": true }, { "text": "√°ltal√°ban egym√°st√≥l f√ºggetlenek", "is_correct": false }, { "text": "a strat√©giai terv alapj√°n k√©sz√≠thet√ºnk √ºzleti tervet", "is_correct": true }], "category": "Strategy & Management" },
            { "question": "V√°lassza ki, hogy melyek igazak a menedzser t√≠pus√∫ v√°llalatalap√≠t√≥ra?", "answers": [{ "text": "fels≈ëfok√∫ v√©gzetts√©ggel rendelkezik", "is_correct": true }, { "text": "specializ√°lt v√°llalatot alap√≠t.", "is_correct": true }, { "text": "k√∂zvetlen helyi ig√©nyek kiel√©g√≠t√©s√©re j√∂n l√©tre.", "is_correct": false }, { "text": "kezdeti siker eset√©n gyors n√∂veked√©snek indul.", "is_correct": true }], "category": "Strategy & Management" },
            { "question": "V√°lassza ki a felsorol√°sb√≥l, hogy melyek a strat√©giai 5P elemei?", "answers": [{ "text": "j√∂v≈ëk√©p", "is_correct": true }, { "text": "viselked√©s minta", "is_correct": true }, { "text": "√°rmeg√°llap√≠t√°s.", "is_correct": false }, { "text": "tr√ºkk", "is_correct": true }], "category": "Strategy & Management" },

            // Category: Marketing & Competition
            { "question": "Az al√°bbiak k√∂z√ºl melyek r√©szei a v√°llalati k√∂rnyezeti t√©nyez≈ëk nagy csoportj√°nak?", "answers": [{ "text": "a politikai k√∂rnyezet", "is_correct": true }, { "text": "a strat√©giai k√∂rnyezet", "is_correct": false }, { "text": "a t√°rsadalmi k√∂rnyezet", "is_correct": true }], "category": "Marketing & Competition" },
            { "question": "Melyik eleme a v√°llalat politikai k√∂rnyezet√©nek?", "answers": [{ "text": "a sz√°ll√≠t√≥k befoly√°sa", "is_correct": false }, { "text": "a vev≈ëk", "is_correct": false }, { "text": "a demogr√°fiai helyzet", "is_correct": true }], "category": "Marketing & Competition" },
            { "question": "Jel√∂lje meg, hogy az al√°bbi √°ll√≠t√°sok igazak! (√úzleti etika)", "answers": [{ "text": "Az √ºzleti etika a helyes √ºzleti viselked√©sr≈ël sz√≥l.", "is_correct": true }, { "text": "Az √ºzleti etika hozz√°j√°rulhat a szerz≈ëd√©sek k√∂lts√©g√©nek cs√∂kkent√©s√©hez.", "is_correct": true }, { "text": "Az √ºzleti etika cs√∂kkenti a partnerek k√∂z√∂tti bizalmat.", "is_correct": false }], "category": "Marketing & Competition" },
            { "question": "Melyek tartoznak az al√°bbiak k√∂z√ºl a PEST-anal√≠zis t√©nyez≈ëcsoportjaihoz?", "answers": [{ "text": "az √©p√≠tett k√∂rnyezet", "is_correct": false }, { "text": "a term√©szeti k√∂rnyezet", "is_correct": true }, { "text": "a t√°rsadalmi k√∂rnyezet", "is_correct": true }], "category": "Marketing & Competition" },
            { "question": "Jel√∂lje meg, hogy mely √°ll√≠t√°s igaz! (PEST-anal√≠zis)", "answers": [{ "text": "A PEST-anal√≠zis k√©sz√≠t√©sekor m√©rhet≈ë t√©nyez≈ëket √©rt√©kel√ºnk.", "is_correct": true }, { "text": "A PEST-anal√≠zis k√©sz√≠t√©sekor nem rendelhet√ºnk s√∫lysz√°mokat az egyes t√©nyez≈ëkh√∂z.", "is_correct": false }, { "text": "A PEST-anal√≠zis k√©sz√≠t√©sekor s√∫lysz√°mokat rendelhet√ºnk a t√©nyez≈ëcsoportokhoz.", "is_correct": true }], "category": "Marketing & Competition" },
            { "question": "D√∂ntse el, hogy az al√°bbi √°ll√≠t√°sok igazak-e! (V√°llalati stakeholderek)", "answers": [{ "text": "A v√°llalati stakeholderek k√∂z√∂tt nem lehet bank.", "is_correct": false }, { "text": "A v√°llalati stakeholderek rendelkezhetnek szavazati joggal.", "is_correct": true }, { "text": "A v√°llalati stakeholderek k√ºl√∂nf√©le befoly√°ssal b√≠rhatnak.", "is_correct": true }], "category": "Marketing & Competition" },
            { "question": "V√°lassza ki, hogy melyek tartoznak a versenystrat√©gia f≈ë t√©nyez≈ëi k√∂z√©!", "answers": [{ "text": "a vev≈ëk alkupoz√≠ci√≥ja", "is_correct": true }, { "text": "a kieg√©sz√≠t≈ë term√©kek √©s azok fenyeget√©se", "is_correct": false }, { "text": "a sz√°ll√≠t√≥k alkupoz√≠ci√≥ja", "is_correct": true }], "category": "Marketing & Competition" },
            { "question": "V√°lassza ki, hogy az al√°bbiak k√∂z√ºl melyik jellemz≈ë a term√©k megk√ºl√∂nb√∂ztet√©s√©n alapul√≥ versenystrat√©gi√°ra!", "answers": [{ "text": "a j√≥ min≈ës√©g", "is_correct": true }, { "text": "az alacsony √°r", "is_correct": false }, { "text": "a m√°rkanev ismerets√©g√©re val√≥ t√∂rekv√©s", "is_correct": true }], "category": "Marketing & Competition" },
            { "question": "V√°lassza ki az al√°bbiak k√∂z√ºl melyik hagyom√°nyos eleme a marketingmixnek!", "answers": [{ "text": "a prom√≥ci√≥s politika", "is_correct": true }, { "text": "a j√∂vedelmez≈ës√©g", "is_correct": false }, { "text": "a teljes√≠tm√©ny (performance)", "is_correct": false }], "category": "Marketing & Competition" },
            { "question": "Jel√∂lje meg a k√∂vetkez≈ë √°ll√≠t√°sok k√∂z√ºl melyik igaz! (Marketing elj√°r√°s)", "answers": [{ "text": "A marketing elj√°r√°s folyamat√°nak els≈ë l√©p√©se a poz√≠cion√°l√°s", "is_correct": false }, { "text": "A marketing szemsz√∂g√©b≈ël a vev≈ë ig√©nyei jelentik a kiindul√≥pontot.", "is_correct": true }, { "text": "A piackutat√°s a marketingtev√©kenys√©g inform√°ci√≥s b√°zisa.", "is_correct": true }], "category": "Marketing & Competition" },
            { "question": "Az al√°bbiak k√∂z√ºl melyek a monopolpiac jellemz≈ëi? Jel√∂lje meg a helyes v√°laszt!", "answers": [{ "text": "csak egyetlen elad√≥ k√≠n√°lja a term√©ket", "is_correct": true }, { "text": "az √°rat maga a v√°llalat hat√°rozza meg", "is_correct": true }, { "text": "a k√≠n√°lt term√©k homog√©n", "is_correct": true }, { "text": "a keresleti g√∂rbe meredeks√©ge √©s a fogyaszt√≥k √°r√©rz√©kenys√©ge adott", "is_correct": true }], "category": "Marketing & Competition" },
            { "question": "Az e-business melyik form√°ja foglalkozik a v√°llalatok k√∂z√∂tti inform√°ci√≥s √©s kereskedelmi folyamatokkal?", "answers": [{ "text": "B2C", "is_correct": false }, { "text": "B2G", "is_correct": false }, { "text": "C2C", "is_correct": false }, { "text": "B2B", "is_correct": true }], "category": "Marketing & Competition" },

            // Category: Operations & Logistics
            { "question": "V√°lassza ki az al√°bbiak k√∂z√ºl, melyik adja a termel√©s inputjait!", "answers": [{ "text": "az √©rt√©kes√≠t√©s", "is_correct": false }, { "text": "a beszerz√©s", "is_correct": true }, { "text": "a tervez√©s", "is_correct": false }], "category": "Operations & Logistics" },
            { "question": "Jel√∂lje meg, hogy az al√°bbi √°ll√≠t√°sok k√∂z√ºl melyik igaz! (Logisztikai tev√©kenys√©g)", "answers": [{ "text": "A logisztikai tev√©kenys√©g nem csak t√©nyleges anyagmozgat√°st jelent.", "is_correct": true }, { "text": "A logisztikai tev√©kenys√©g kapcsol√≥dik a termel√©shez.", "is_correct": true }, { "text": "A logisztikai tev√©kenys√©g a beszerz√©shez nem kapcsol√≥dik.", "is_correct": false }], "category": "Operations & Logistics" },
            { "question": "V√°lassza ki, hogy melyik esetben kell k√∂zbeszerz√©si elj√°r√°st lefolytatni!", "answers": [{ "text": "minden √©p√≠t√©si munk√°n√°l", "is_correct": false }, { "text": "ha az √∂nkorm√°nyzat a t√∂rv√©nyi √©rt√©khat√°r feletti √©p√≠t√©si munk√°t v√©geztet", "is_correct": true }, { "text": "minden szolg√°ltat√°s ig√©nybev√©tel√©re, √©rt√©khat√°rt√≥l f√ºggetlen√ºl", "is_correct": false }], "category": "Operations & Logistics" },
            { "question": "Jel√∂lje meg, hogy az al√°bbiak k√∂z√ºl melyik √°ll√≠t√°s igaz! (Nagy k√©szletek)", "answers": [{ "text": "A nagy k√©szletek a termel√©s ell√°t√°s√°t bizonytalann√° teszik.", "is_correct": false }, { "text": "A nagy k√©szletek gazdas√°gtalann√° tehetik a termel√©st.", "is_correct": true }, { "text": "A nagy k√©szletek a termel√©s ell√°t√°s√°t biztons√°gosabb√° teszik.", "is_correct": true }], "category": "Operations & Logistics" },
            { "question": "V√°lassza ki, hogy melyek jelentenek d√∂nt√©si szempontot a termelni-v√°s√°rolni k√∂z√∂tt!", "answers": [{ "text": "kereslet nagys√°ga", "is_correct": false }, { "text": "min≈ës√©gi k√©rd√©sek", "is_correct": true }, { "text": "gazdas√°gi k√©rd√©sek", "is_correct": true }], "category": "Operations & Logistics" },
            { "question": "Melyik meg√°llap√≠t√°sok helyesek? A logisztikai tev√©kenys√©g kapcsol√≥dik...", "answers": [{ "text": "a termel√©shez", "is_correct": true }, { "text": "a strat√©giai tervez√©shez", "is_correct": false }, { "text": "az √©rt√©kes√≠t√©shez", "is_correct": true }], "category": "Operations & Logistics" },
            { "question": "Az ell√°t√°si l√°nc megval√≥sul√°si szintjei k√∂z√© tartozik:", "answers": [{ "text": "k√∂zvetlen ell√°t√°si l√°nc", "is_correct": true }, { "text": "t√°gan √©rtelmezett ell√°t√°si l√°nc", "is_correct": true }, { "text": "k√∂zvetett ell√°t√°si l√°nc", "is_correct": false }, { "text": "kiterjesztett ell√°t√°si l√°nc", "is_correct": true }], "category": "Operations & Logistics" },
            { "question": "A gy√°rt√°si rendszer jelleg√©re vonatkoz√≥ t√≠pusok k√∂z√© tartozik:", "answers": [{ "text": "projektrendszer≈± gy√°rt√°s", "is_correct": true }, { "text": "folyamatrendszer≈± gy√°rt√°s", "is_correct": true }, { "text": "szakaszrendszer≈± gy√°rt√°s", "is_correct": false }, { "text": "m≈±helyrendszer≈± gy√°rt√°s", "is_correct": true }], "category": "Operations & Logistics" },
            { "question": "D√∂ntse el, hogy az al√°bbi √°ll√≠t√°sok k√∂z√ºl melyik igaz!", "answers": [{ "text": "A termel√©si hat√©konys√°g egyik f≈ë t√©nyez≈ëje a folyamatos fejleszt√©s.", "is_correct": true, "correct_answer": "igaz" }, { "text": "A term√©kszerkezet √©s a gy√°rt√°si technol√≥gia meghat√°roz√≥ a termel√©si strat√©gia kidolgoz√°sa sor√°n.", "is_correct": true, "correct_answer": "igaz" }, { "text": "A v√°llalat a termel√©s sor√°n k√∂zvetlen kapcsolatba l√©p a fogyaszt√≥val.", "is_correct": false, "correct_answer": "hamis" }], "category": "Operations & Logistics" },

            // Category: Finance & Investment
            { "question": "V√°lassza ki, hogy az al√°bbiak k√∂z√ºl melyek a sz√°mviteli tev√©kenys√©g eredm√©nyei!", "answers": [{ "text": "a m√©rleg", "is_correct": true }, { "text": "a v√°llalat√©rt√©kel√©s", "is_correct": false }, { "text": "az eredm√©nykimutat√°s", "is_correct": true }], "category": "Finance & Investment" },
            { "question": "Melyik amortiz√°ci√≥s m√≥dszerrel tudjuk a legnagyobb t≈ëkeforr√°st teremteni, ha minden egy√©b t√©nyez≈ë v√°ltozatlan? Jel√∂lje meg a helyes v√°laszt!", "answers": [{ "text": "Line√°ris le√≠r√°s", "is_correct": false }, { "text": "√âvek sz√°ma √∂sszege m√≥dszer", "is_correct": false }, { "text": "Egys√©g√∂sszeg≈±, abszol√∫t √©rt√©k≈± le√≠r√°s az √ºzembehelyez√©skor", "is_correct": true }, { "text": "Teljes√≠tm√©nyar√°nyos nett√≥ √©rt√©k alap√∫ le√≠r√°s", "is_correct": false }], "category": "Finance & Investment" },
            { "question": "Egy marad√©k√©rt√©kes le√≠r√°sn√°l a brutt√≥ √©rt√©k 25% -a tervezett marad√©k√©rt√©k. A g√©pet 5 √©vig fogj√°k haszn√°lni. Mekkora lesz a le√≠r√°si kulcs (L_m)? Jel√∂lje meg a helyes v√°laszt!", "answers": [{ "text": "24,2%", "is_correct": true }, { "text": "22%", "is_correct": false }, { "text": "28,5%", "is_correct": false }, { "text": "20%", "is_correct": false }], "category": "Finance & Investment" },
            { "question": "Egy 2 milli√≥ Ft-os g√©p amortiz√°ci√≥j√°t t≈ëk√©s√≠tik az √©lettartam 4 √©ve alatt, az adott √©v v√©g√©n mindig kiveszik a kamatokat, hogy karbantart√°si munk√°kat fedezz√©k bel≈ële. Bet√©ti kamat 6%. Mennyi t≈ëkeforr√°s fog rendelkez√©sre √°llni az utols√≥ haszn√°lati √©v ut√°n 1 h√≥nappal?", "answers": [{ "text": "2000 EFt", "is_correct": false }, { "text": "1800 EFt", "is_correct": false }, { "text": "2120 EFt", "is_correct": true }, { "text": "2006 EFt", "is_correct": false }], "category": "Finance & Investment" },
            { "question": "Milyen esetben nem javasolt a beruh√°z√°s megval√≥s√≠t√°sa? Jel√∂lje meg a helyes v√°laszt!", "answers": [{ "text": "PI>1", "is_correct": false }, { "text": "P < IRR", "is_correct": false }, { "text": "BFS>1", "is_correct": false }, { "text": "NPV<0", "is_correct": true }], "category": "Finance & Investment" },
            { "question": "Mekkora a statikus megt√©r√ºl√©si ideje egy √©vi √°tlagosan 230 EFt nyeres√©get biztos√≠t√≥ 1.380 EFt √©rt√©k≈± beruh√°z√°snak, ha azt 7 √©vig amortiz√°ln√°k? Jel√∂lje meg a helyes v√°laszt!", "answers": [{ "text": "4 √©v", "is_correct": false }, { "text": "5 √©v", "is_correct": false }, { "text": "6 √©v", "is_correct": true }, { "text": "7 √©v", "is_correct": false }], "category": "Finance & Investment" },
            { "question": "D√∂ntse el, hogy egy 3 √©v m√∫lva esed√©kes 3.400 EFt mai √©rt√©ken mennyit √©r, ha az √°llampap√≠r-piaci referenciahozam 4,4%! eg√©sz ezresekre kerek√≠tsen!", "answers": [{ "text": "2985 EFt", "is_correct": false }, { "text": "3400 EFt", "is_correct": false }, { "text": "2988 EFt", "is_correct": true }, { "text": "2888 EFt", "is_correct": false }], "category": "Finance & Investment" },
            { "question": "Mi k√©pezheti beruh√°z√°s t√°rgy√°t?", "answers": [{ "text": "A selejt t√°rgyi eszk√∂z√∂k p√≥tl√°sa, cser√©je.", "is_correct": true }, { "text": "A dolgoz√≥k sz√°m√°ra osztott √©tkez√©si jegyek beszerz√©se.", "is_correct": false }, { "text": "A lej√°rt szavatoss√°g√∫ elad√°sra sz√°nt rakt√°rk√©szlet p√≥tl√°sa.", "is_correct": false }, { "text": "A lemezhajl√≠t√°st v√©gz≈ë eszk√∂z karbantart√°sa.", "is_correct": false }], "category": "Finance & Investment" },
            { "question": "V√°lassza ki a felsorol√°sb√≥l, hogy mely mutat√≥k m√©rik a likvidit√°st?", "answers": [{ "text": "K√©szletforg√°si mutat√≥: √ârt√©kes√≠t√©s nett√≥ √°rbev√©tele vagy √ârt√©kes√≠tett term√©kek k√∂lts√©gei/K√©szlet√°llom√°ny.", "is_correct": false }, { "text": "Elad√≥sodotts√°gi mutat√≥: √ñsszes idegen forr√°s/Saj√°t t≈ëke.", "is_correct": false }, { "text": "A forg√≥t≈ëke ar√°nya mutat√≥ (likvidit√°si mutat√≥): Forg√≥eszk√∂z√∂k/R√∂vid lej√°rat√∫ tartoz√°sok.", "is_correct": true }, { "text": "Likvidit√°si gyorsmutat√≥ (gyorsteszt): (Forg√≥eszk√∂z√∂k - K√©szletek)/(R√∂vid lej√°rat√∫ tartoz√°sok - Sz√°mlahitel)", "is_correct": true }], "category": "Finance & Investment" },

            // Category: HR, IT & Innovation
            { "question": "V√°lassza ki, hogy melyik tartozik a v√°llalati szem√©ly√ºgyi munka k√∂rnyezeti felt√©teleihez!", "answers": [{ "text": "a sz√°ll√≠t√≥k", "is_correct": false }, { "text": "a munkaer≈ëpiac", "is_correct": true }, { "text": "a logisztikai kult√∫ra", "is_correct": false }], "category": "HR, IT & Innovation" },
            { "question": "V√°lassza ki, hogy az al√°bbiak k√∂z√ºl melyek tartoznak a szem√©ly√ºgyi funkci√≥ szakmai ter√ºleteihez!", "answers": [{ "text": "toborz√°s, k√©pz√©s, b√©r- √©s j√∂vedelempolitika", "is_correct": true }, { "text": "karriertervez√©s", "is_correct": true }, { "text": "√©rdekv√©delem", "is_correct": false }], "category": "HR, IT & Innovation" },
            { "question": "Jel√∂lje meg a k√∂vetkez≈ë √°ll√≠t√°sok k√∂z√ºl melyik igaz! (Innov√°ci√≥)", "answers": [{ "text": "Az innov√°ci√≥ mindig a termel√©si vezet≈ë ir√°ny√≠t√°sa alatt √°ll.", "is_correct": false }, { "text": "Az innov√°ci√≥ marketing ind√≠ttat√°s√∫ is lehet.", "is_correct": true }, { "text": "Az innov√°ci√≥ folyamata csigavonallal √≠rhat√≥ le.", "is_correct": true }], "category": "HR, IT & Innovation" },
            { "question": "Jel√∂lje meg, hogy az al√°bbi √°ll√≠t√°sok k√∂z√ºl melyik igaz! (V√°llalati inform√°ci√≥s rendszerek)", "answers": [{ "text": "A v√°llalati inform√°ci√≥s rendszerekkel szemben t√°masztott k√∂vetelm√©nyek k√∂z√© tartozik, hogy - a vezet≈ëk inform√°lts√°g-szintje a felel≈ëss√©g√ºkkel √∂sszhangban legyen.", "is_correct": true }, { "text": "- teljes√≠tse az el≈ë√≠rt adatszolg√°ltat√°si k√∂telezetts√©geket.", "is_correct": true }, { "text": "A v√°llalati inform√°ci√≥s rendszerekkel mindig egyedi fejleszt√©s≈±ek.", "is_correct": false }], "category": "HR, IT & Innovation" },
            { "question": "V√°lassza ki a megfelel≈ë inform√°ci√≥t!", "answers": [{ "text": "a val√≥s√°got t√ºkr√∂zi", "is_correct": true }, { "text": "idej√©ben √©rkezik", "is_correct": true }, { "text": "nincs meghat√°rozott tartalma", "is_correct": false }], "category": "HR, IT & Innovation" },
            { "question": "Melyik a legmodernebb innov√°ci√≥s modell?", "answers": [{ "text": "ny√≠lt", "is_correct": false }, { "text": "z√°rt", "is_correct": false }, { "text": "living lab", "is_correct": true }], "category": "HR, IT & Innovation" },
            { "question": "Ki foglalkozott innov√°ci√≥menedzsmenttel?", "answers": [{ "text": "Le Hub", "is_correct": false }, { "text": "Drucker", "is_correct": false }, { "text": "Schumpeter", "is_correct": true }], "category": "HR, IT & Innovation" },
            { "question": "Az al√°bbiak k√∂z√ºl melyik nem lehet a Triple Helix modell szerepl≈ëje?", "answers": [{ "text": "kutat√≥k√∂zpont", "is_correct": false }, { "text": "start-up", "is_correct": false }, { "text": "korm√°nyablak", "is_correct": true }], "category": "HR, IT & Innovation" },
            { "question": "V√°lassza ki a felsorol√°sb√≥l, hogy melyek igazak Ipar 4.0-ra?", "answers": [{ "text": "a gy√°rt√°s dinamikusabb, decentraliz√°lt", "is_correct": true }, { "text": "M2M technol√≥gia megl√©t√©t ig√©nyli", "is_correct": true }, { "text": "a term√©kek √©s az alkatr√©szek szerepe cs√∂kken a termel√©si folyamatban", "is_correct": false }, { "text": "legf≈ëbb kih√≠v√°sainak egyike a szervezeti meg√∫jul√°s k√©pess√©ge", "is_correct": true }], "category": "HR, IT & Innovation" },
            { "question": "A szem√©ly√ºgyi tev√©kenys√©gek fejl≈ëd√©s√©nek milyen szakaszait ismerj√ºk? Jel√∂lje meg a helyes v√°laszt!", "answers": [{ "text": "Szem√©ly√ºgyi gazd√°lkod√°s", "is_correct": true }, { "text": "Hum√°n er≈ëforr√°s menedzsment", "is_correct": true }, { "text": "Nemzetk√∂zi √∂sszehasonl√≠t√≥ HRM", "is_correct": false }, { "text": "Szem√©ly√ºgyi adminisztr√°ci√≥", "is_correct": true }], "category": "HR, IT & Innovation" },
            { "question": "A 3D nyomtat√°s sor√°n k√©sz√≠tett tesztelhet≈ë protot√≠pusok melyik inform√°ci√≥s rendszer r√©sze? Jel√∂lje meg a helyes v√°laszt!", "answers": [{ "text": "CAM", "is_correct": false }, { "text": "DSS", "is_correct": false }, { "text": "CAD", "is_correct": true }, { "text": "Szak√©rt≈ëi rendszerek", "is_correct": false }], "category": "HR, IT & Innovation" },
            
            // Category: Quality & Standards
            { "question": "V√°lassza ki a v√°llalati szabv√°nyos rendszerek jellemz≈ëit!", "answers": [{ "text": "alapdokumentumuk a k√©zik√∂nyv", "is_correct": true }, { "text": "nem tan√∫s√≠ttathat√≥k", "is_correct": false }, { "text": "funkci√≥kat keresztez≈ë tev√©kenys√©gek", "is_correct": true }], "category": "Quality & Standards" },
            { "question": "Jel√∂lje meg a k√∂vetkez≈ë √°ll√≠t√°sok k√∂z√ºl melyik igaz! (Min≈ës√©g√ºgyi rendszer)", "answers": [{ "text": "A min≈ës√©g√ºgyi rendszer szabv√°nya az ISO 9001.", "is_correct": true }, { "text": "A k√∂rnyezetir√°ny√≠t√°si rendszer szabv√°nya az MSZ 28001.", "is_correct": true }, { "text": "A munkahelyi eg√©szs√©g √©s biztons√°g k√∂vetelm√©nyszabv√°nya az ISO 9001.", "is_correct": false }], "category": "Quality & Standards" },
            { "question": "V√°lassza ki az al√°bbiak k√∂z√ºl az ISO 9001-es szabv√°ny k√∂vetelm√©nyeit!", "answers": [{ "text": "a vev≈ëi ig√©nyek figyelembe v√©tele", "is_correct": true }, { "text": "a k√∂rnyezeti politika kidolgoz√°sa", "is_correct": false }, { "text": "a m√©r≈ëeszk√∂z√∂k kezel√©se", "is_correct": true }], "category": "Quality & Standards" },
            { "question": "V√°lassza ki az al√°bbiak k√∂z√ºl a k√∂rnyezetir√°ny√≠t√°s szabv√°ny√°t!", "answers": [{ "text": "ISO 14004", "is_correct": false }, { "text": "ISO 14001", "is_correct": true }, { "text": "ISO 9004", "is_correct": false }], "category": "Quality & Standards" },
            { "question": "V√°lassza ki az al√°bbiak k√∂z√ºl az ISO 14001-es szabv√°ny k√∂vetelm√©nyeit!", "answers": [{ "text": "k√∂rnyezetpolitika kidolgoz√°sa", "is_correct": true }, { "text": "v√©grehajt√°s √©s m≈±k√∂d√©s szab√°lyoz√°sa", "is_correct": true }, { "text": "min≈ës√©gi vezet≈ë kinevez√©se", "is_correct": false }], "category": "Quality & Standards" },
            { "question": "Jel√∂lje meg, hogy az al√°bbi √°ll√≠t√°sok k√∂z√ºl melyik igaz! (Min≈ës√©gi rendszer m≈±k√∂d√©se)", "answers": [{ "text": "A min≈ës√©gi rendszer m≈±k√∂d√©s√©t k√ºls≈ë √©s bels≈ë auditokkal ellen≈ërzik.", "is_correct": true }, { "text": "A tan√∫s√≠t√°st csak f√ºggetlen tan√°csad√≥ v√©gezheti.", "is_correct": true }, { "text": "A rendszerek k√∂zvetlen ir√°ny√≠t√°s√°t mindig a legfels≈ë vezet≈ë v√©gzi.", "is_correct": false }], "category": "Quality & Standards" },
            { "question": "Jel√∂lje meg, hogy az al√°bbi √°ll√≠t√°sok k√∂z√ºl melyik igaz! (Munkahelyi eg√©szs√©g)", "answers": [{ "text": "A munkahelyi eg√©szs√©g rendszere az ISO 9001 szabv√°ny szerint √©p√≠thet≈ë ki.", "is_correct": true }, { "text": "A munkahelyi eg√©szs√©g √©s biztons√°g rendszere nem tan√∫s√≠ttathat√≥.", "is_correct": false }, { "text": "A munkahelyi eg√©szs√©gi rendszer k√∂zvetlen ir√°ny√≠t√°s√°t a legfels≈ë vezet≈ë v√©gzi.", "is_correct": false }], "category": "Quality & Standards" }
        ];

        const QUIZ_SIZE = 20;
        let selectedQuizQuestions = [];
        let currentQuestionIndex = 0;
        let answeredCorrectlyCount = 0;

        const quizContainer = document.getElementById('quiz-container');
        const questionText = document.getElementById('question-text');
        const answersContainer = document.getElementById('answers-container');
        const feedbackMessage = document.getElementById('feedback-message');
        const submitButton = document.getElementById('submit-button');
        const nextButton = document.getElementById('next-button');
        const resultsContainer = document.getElementById('results-container');
        const scoreText = document.getElementById('score-text');
        const restartButton = document.getElementById('restart-button');
        const currentQuestionNumberSpan = document.getElementById('current-question-number');
        const totalQuizQuestionsSpan = document.getElementById('total-quiz-questions');

        // Function to shuffle an array (Fisher-Yates shuffle)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Function to select a balanced set of questions
        function generateQuizQuestions() {
            const categorizedQuestions = allQuizData.reduce((acc, question) => {
                if (!acc[question.category]) {
                    acc[question.category] = [];
                }
                acc[question.category].push(question);
                return acc;
            }, {});

            let tempSelectedQuestions = [];
            const totalQuestionsToPick = QUIZ_SIZE;
            const totalSourceQuestions = allQuizData.length;

            // Shuffle questions within each category first
            for (const category in categorizedQuestions) {
                shuffleArray(categorizedQuestions[category]);
            }

            // Calculate how many questions to pick from each category proportionally
            const questionsToPickPerCategory = {};
            let pickedCount = 0;
            for (const category in categorizedQuestions) {
                const proportion = categorizedQuestions[category].length / totalSourceQuestions;
                questionsToPickPerCategory[category] = Math.round(proportion * totalQuestionsToPick);
                pickedCount += questionsToPickPerCategory[category];
            }

            // Adjust if rounding caused the total to be off
            let difference = pickedCount - totalQuestionsToPick;
            while(difference !== 0) {
                 const categoryKeys = Object.keys(categorizedQuestions);
                 const randomCategory = categoryKeys[Math.floor(Math.random() * categoryKeys.length)];
                 if (difference > 0 && questionsToPickPerCategory[randomCategory] > 0) {
                     questionsToPickPerCategory[randomCategory]--;
                     difference--;
                 } else if (difference < 0 && questionsToPickPerCategory[randomCategory] < categorizedQuestions[randomCategory].length) {
                     questionsToPickPerCategory[randomCategory]++;
                     difference++;
                 }
            }
            
            // Pick the calculated number of questions from each category
            for (const category in questionsToPickPerCategory) {
                const count = questionsToPickPerCategory[category];
                tempSelectedQuestions.push(...categorizedQuestions[category].slice(0, count));
            }

            // Final shuffle of the selected questions
            shuffleArray(tempSelectedQuestions);
            selectedQuizQuestions = tempSelectedQuestions;
            totalQuizQuestionsSpan.textContent = selectedQuizQuestions.length;
        }

        // Function to display the current question
        function displayQuestion() {
            answersContainer.innerHTML = '';
            feedbackMessage.classList.add('hidden');
            feedbackMessage.className = 'feedback-message hidden'; // Reset all feedback classes
            submitButton.classList.remove('hidden');
            submitButton.disabled = true;
            nextButton.classList.add('hidden');
            nextButton.disabled = true;

            currentQuestionNumberSpan.textContent = currentQuestionIndex + 1;

            if (currentQuestionIndex < selectedQuizQuestions.length) {
                const question = selectedQuizQuestions[currentQuestionIndex];
                questionText.textContent = question.question;

                const correctAnswersCount = question.answers.filter(a => a.is_correct).length;
                const inputType = correctAnswersCount === 1 ? 'radio' : 'checkbox';

                question.answers.forEach((answer, index) => {
                    const label = document.createElement('label');
                    label.className = 'answer-option-label relative text-gray-700';

                    const input = document.createElement('input');
                    input.type = inputType;
                    input.name = 'answer-' + currentQuestionIndex;
                    input.value = index;
                    input.className = 'answer-input';

                    input.addEventListener('change', () => {
                        const anyChecked = answersContainer.querySelector('input:checked');
                        submitButton.disabled = !anyChecked;
                    });

                    const span = document.createElement('span');
                    span.textContent = answer.text;
                    span.className = 'text-base flex-grow';

                    label.appendChild(input);
                    label.appendChild(span);
                    answersContainer.appendChild(label);
                });
            } else {
                showResults();
            }
        }

        // Function to check the selected answer(s)
        function checkAnswer() {
            submitButton.disabled = true;
            nextButton.classList.remove('hidden');
            nextButton.disabled = false;

            const question = selectedQuizQuestions[currentQuestionIndex];
            const selectedAnswerInputs = Array.from(answersContainer.querySelectorAll('input:checked'));
            const selectedAnswersValues = selectedAnswerInputs.map(input => parseInt(input.value));
            const correctAnswersIndices = question.answers.map((answer, index) => answer.is_correct ? index : -1).filter(index => index !== -1);

            let isCurrentQuestionCorrect = selectedAnswersValues.length === correctAnswersIndices.length &&
                                         correctAnswersIndices.every(correctIndex => selectedAnswersValues.includes(correctIndex));

            if (isCurrentQuestionCorrect) {
                answeredCorrectlyCount++;
                feedbackMessage.textContent = 'Correct! üéâ';
                feedbackMessage.classList.add('feedback-correct');
            } else {
                feedbackMessage.textContent = 'Incorrect! üòî';
                feedbackMessage.classList.add('feedback-incorrect');
            }
            feedbackMessage.classList.remove('hidden');

            // Highlight answers and disable all inputs
            question.answers.forEach((answer, index) => {
                const label = answersContainer.querySelector(`label:nth-child(${index + 1})`);
                const input = label.querySelector('input');
                input.disabled = true;

                if (answer.is_correct) {
                    label.classList.add('correct-highlight');
                } else if (selectedAnswersValues.includes(index)) {
                    label.classList.add('incorrect-highlight');
                }
            });
        }

        // Function to move to the next question
        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < selectedQuizQuestions.length) {
                displayQuestion();
            } else {
                showResults();
            }
        }

        // Function to show quiz results
        function showResults() {
            quizContainer.classList.add('hidden');
            resultsContainer.classList.remove('hidden');
            const finalScore = selectedQuizQuestions.length > 0 ? (answeredCorrectlyCount / selectedQuizQuestions.length) * 100 : 0;
            scoreText.innerHTML = `You answered <strong class="text-blue-600">${answeredCorrectlyCount}</strong> out of <strong class="text-blue-600">${selectedQuizQuestions.length}</strong> questions correctly.<br>Your score: <strong class="text-blue-600">${finalScore.toFixed(1)}%</strong>`;
        }

        function startNewQuiz() {
            currentQuestionIndex = 0;
            answeredCorrectlyCount = 0;
            resultsContainer.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            generateQuizQuestions();
            displayQuestion();
        }

        // Event Listeners
        submitButton.addEventListener('click', checkAnswer);
        nextButton.addEventListener('click', nextQuestion);
        restartButton.addEventListener('click', startNewQuiz);

        // Initial quiz setup
        window.onload = startNewQuiz;
    </script>
</body>
</html>
